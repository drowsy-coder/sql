-- 1. Create a table students with NOT NULL constraint on sname
CREATE TABLE students (
    sname VARCHAR2(100) NOT NULL,
    regno VARCHAR2(20),
    dept VARCHAR2(50),
    year NUMBER,
    ccode VARCHAR2(20),
    mark NUMBER,
    average NUMBER,
    grade CHAR(1)
);

-- 2. Display the structure of the table students
DESC students;

-- 3. Insert a record in the students table with regno 22BCEC1001
INSERT INTO students (sname, regno, dept, year, mark) VALUES ('John Doe', '22BCEC1001', 'CSE', 2, 85);

-- 4. Insert a record with empty value in sname column and identify the kind of error
-- This will cause an error because sname cannot be NULL
-- INSERT INTO students (sname, regno, dept, year, mark) VALUES (NULL, '22BCEC1002', 'ECE', 1, 75);

-- 5. Add primary key constraint - Regno column as Primary Key
ALTER TABLE students ADD CONSTRAINT pk_regno PRIMARY KEY (regno);

-- 6. Insert a record with the same reg.no 22BCE1001 and identify the violation
-- This will cause a unique constraint violation error
-- INSERT INTO students (sname, regno, dept, year, mark) VALUES ('Jane Smith', '22BCEC1001', 'MECH', 3, 88);

-- 7. Add check constraint for Mark column with constraint name and mark between 1 and 100
ALTER TABLE students ADD CONSTRAINT chk_mark CHECK (mark BETWEEN 1 AND 100);

-- 8. Insert two records in students table with mark as -5 in one record and 110 in another record. Find the appropriate violation.
-- Both inserts will fail due to the check constraint
-- INSERT INTO students (sname, regno, dept, year, mark) VALUES ('Alice', '22BCEC1003', 'CIVIL', 4, -5);
-- INSERT INTO students (sname, regno, dept, year, mark) VALUES ('Bob', '22BCEC1004', 'ELEC', 1, 110);

-- 9. Add default constraint (0 as default value) to the column Average in the students table
ALTER TABLE students MODIFY average NUMBER DEFAULT 0;

-- 10. Insert a record into students without giving any value in Average column
INSERT INTO students (sname, regno, dept, year, mark) VALUES ('Carol', '22BCEC1005', 'IT', 2, 92);

-- 11. Display the students detail and to know the functionality of default constraint with default value
SELECT * FROM students;

-- 12. Create another table course as per the schema,
CREATE TABLE course (
    cname VARCHAR2(100) NOT NULL,
    ccode VARCHAR2(20) PRIMARY KEY
);

-- 13. Display the structure of the course table
DESC course;

-- 14. Insert 5 records in the course table
INSERT INTO course VALUES ('Database Systems', 'DB101');
INSERT INTO course VALUES ('Operating Systems', 'OS102');
INSERT INTO course VALUES ('Computer Networks', 'CN103');
INSERT INTO course VALUES ('Software Engineering', 'SE104');
INSERT INTO course VALUES ('Artificial Intelligence', 'AI105');

-- 15. Display the records from course table
SELECT * FROM course;

-- 16. Now, add foreign key constraint to the column Ccode in the table students.
-- First, ensure no invalid ccode exists in students
-- Then, add the foreign key constraint
ALTER TABLE students ADD CONSTRAINT fk_ccode FOREIGN KEY (ccode) REFERENCES course(ccode);

-- 18. Insert 2 records in the students table. Enter the value of ccode of student table that matches the value of ccode of Course table.
INSERT INTO students (sname, regno, dept, year, ccode, mark) VALUES ('Dave', '22BCEC1006', 'CSE', 3, 'DB101', 75);
INSERT INTO students (sname, regno, dept, year, ccode, mark) VALUES ('Eve', '22BCEC1007', 'MECH', 1, 'OS102', 88);

-- 19. Insert 1 record in the students table. Enter the value of ccode of student table that does not match the value of ccode of Course table.
-- This will fail due to the foreign key constraint
-- INSERT INTO students (sname, regno, dept, year, ccode, mark) VALUES ('Frank', '22BCEC1008', 'ECE', 2, 'CS106', 90);

-- 20. Drop the check constraint
ALTER TABLE students DROP CONSTRAINT chk_mark;

-- 21. Delete all the records from course table.
-- This will fail if there are dependencies in students
-- DELETE FROM course;

-- 22. Identify the type of violation from the previous query and find the solution to delete all the records from course table
-- To delete, first remove or adjust the foreign key constraint or delete dependent records in students
-- ALTER TABLE students DROP CONSTRAINT fk_ccode;
-- DELETE FROM course;
